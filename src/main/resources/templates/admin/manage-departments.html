<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head}"></head>
<body>
	<nav th:replace="~{fragments/header :: navbar}"></nav>

	<div class="container-fluid">
		<div class="row">
			<div class="col-md-2 sidebar p-0">
				<div class="p-3">
					<h5 class="text-white">
						<i class="fas fa-user-shield"></i> Admin Panel
					</h5>
				</div>
				<ul class="nav flex-column">
					<li class="nav-item"><a class="nav-link"
						th:href="@{/admin/dashboard}"> <i class="fas fa-dashboard"></i>
							Dashboard
					</a></li>
					<li class="nav-item"><a class="nav-link active"
						th:href="@{/admin/departments}"> <i class="fas fa-building"></i>
							Departments
					</a></li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/admin/doctors}"> <i class="fas fa-user-md"></i>
							Doctors
					</a></li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/admin/appointments}"> <i class="fas fa-calendar"></i>
							Appointments
					</a></li>
				</ul>
			</div>

			<div class="col-md-10 p-4">
				<h2 class="mb-4">
					<i class="fas fa-building"></i> Manage Departments
				</h2>

				<div th:if="${success}" class="alert alert-success"
					th:text="${success}"></div>
				<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

				<!-- Add Department Form -->
				<div class="card mb-4">
					<div class="card-header">
						<h5>
							<i class="fas fa-plus"></i> Add New Department
						</h5>
					</div>
					<div class="card-body">
						<form th:action="@{/admin/departments/add}"
							th:object="${department}" method="post">
							<div class="row">
								<div class="col-md-5">
									<input type="text" class="form-control" th:field="*{name}"
										placeholder="Department Name" required>
								</div>
								<div class="col-md-5">
									<input type="text" class="form-control"
										th:field="*{description}" placeholder="Description">
								</div>
								<div class="col-md-2">
									<button type="submit" class="btn btn-primary w-100">
										<i class="fas fa-plus"></i> Add
									</button>
								</div>
							</div>
						</form>
					</div>
				</div>

				<!-- Departments List -->
				<div class="card">
					<div class="card-header">
						<h5>
							<i class="fas fa-list"></i> All Departments
						</h5>
					</div>
					<div class="card-body">
						<table class="table table-hover">
							<thead>
								<tr>
									<th>ID</th>
									<th>Name</th>
									<th>Description</th>
									<th>Doctors</th>
									<th>Actions</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="dept : ${departments}">
									<td th:text="${dept.id}">1</td>
									<td th:text="${dept.name}">Cardiology</td>
									<td th:text="${dept.description}">Heart Care</td>
									<td><span class="badge bg-info"
										th:text="${dept.doctorCount}">0</span></td>
									<td>
										<form
											th:action="@{/admin/departments/delete/{id}(id=${dept.id})}"
											method="post" class="d-inline"
											onsubmit="return confirm('Are you sure you want to delete this department?')">
											<button type="submit" class="btn btn-danger btn-sm">
												<i class="fas fa-trash"></i> Delete
											</button>
										</form>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div th:replace="~{fragments/header :: scripts}"></div>
</body>
</html>