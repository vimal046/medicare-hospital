<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/header :: head}"></head>
<body>
	<nav th:replace="~{fragments/header :: navbar}"></nav>

	<div class="container-fluid">
		<div class="row">
			<div class="col-md-2 p-0">
				<div th:replace="~{fragments/header :: patient-sidebar}"></div>
			</div>

			<div class="col-md-10 p-4">
				<div class="d-flex justify-content-between align-items-center mb-4">
					<h2 class="page-title mb-0">
						<i class="fas fa-calendar-alt"></i> My Appointments
					</h2>
					<a th:href="@{/patient/appointments/book}" class="btn btn-primary">
						<i class="fas fa-plus"></i> Book New Appointment
					</a>
				</div>

				<div th:if="${success}" class="alert alert-success"
					th:text="${success}"></div>
				<div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>

				<!-- Statistics Cards -->
				<div class="row g-4 mb-4">
					<div class="col-md-4">
						<div class="card border-0 shadow-sm">
							<div class="card-body text-center p-4">
								<i class="fas fa-calendar-alt fa-3x mb-3"
									style="color: var(--primary-color);"></i>
								<h3 class="fw-bold" th:text="${#lists.size(appointments)}">0</h3>
								<p class="text-secondary mb-0">Total Appointments</p>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="card border-0 shadow-sm">
							<div class="card-body text-center p-4">
								<i class="fas fa-clock fa-3x mb-3"
									style="color: var(--warning-color);"></i>
								<h3 class="fw-bold"
									th:text="${#lists.size(appointments.?[status == 'SCHEDULED'])}">0</h3>
								<p class="text-secondary mb-0">Scheduled</p>
							</div>
						</div>
					</div>
					<div class="col-md-4">
						<div class="card border-0 shadow-sm">
							<div class="card-body text-center p-4">
								<i class="fas fa-check-circle fa-3x mb-3"
									style="color: var(--success-color);"></i>
								<h3 class="fw-bold"
									th:text="${#lists.size(appointments.?[status == 'COMPLETED'])}">0</h3>
								<p class="text-secondary mb-0">Completed</p>
							</div>
						</div>
					</div>
				</div>

				<!-- Appointments List -->
				<div class="card">
					<div class="card-header">
						<h5 class="mb-0">
							<i class="fas fa-list"></i> All Appointments
						</h5>
					</div>
					<div class="card-body p-0">
						<div class="table-responsive">
							<table class="table table-hover mb-0">
								<thead>
									<tr>
										<th>ID</th>
										<th>Doctor</th>
										<th>Department</th>
										<th>Date & Time</th>
										<th>Status</th>
										<th>Actions</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="apt : ${appointments}">
										<td><strong th:text="'#' + ${apt.id}">1</strong></td>
										<td><i class="fas fa-user-md text-primary"></i> <strong
											th:text="${apt.doctorName}">Dr. Smith</strong></td>
										<td><span class="badge bg-info"
											th:text="${apt.departmentName}">Cardiology</span></td>
										<td>
											<div>
												<i class="fas fa-calendar text-secondary"></i> <span
													th:text="${apt.appointmentDate}">2025-01-15</span>
											</div>
											<div>
												<i class="fas fa-clock text-secondary"></i> <span
													th:text="${apt.appointmentTime}">10:00</span>
											</div>
										</td>
										<td><span class="badge"
											th:classappend="${apt.status == 'SCHEDULED' ? 'bg-primary' : (apt.status == 'COMPLETED' ? 'bg-success' : 'bg-danger')}"
											th:text="${apt.status}">SCHEDULED</span></td>
										<td>
											<form th:if="${apt.status == 'SCHEDULED'}"
												th:action="@{/patient/appointments/{id}/cancel(id=${apt.id})}"
												method="post" class="d-inline"
												onsubmit="return confirm('Are you sure you want to cancel this appointment?')">
												<button type="submit" class="btn btn-danger btn-sm">
													<i class="fas fa-times"></i> Cancel
												</button>
											</form> <span th:if="${apt.status != 'SCHEDULED'}"
											class="text-secondary small">No actions</span>
										</td>
									</tr>
									<tr th:if="${#lists.isEmpty(appointments)}">
										<td colspan="6" class="text-center py-5 text-secondary">
											<i class="fas fa-inbox fa-4x mb-3 d-block"></i>
											<h5 class="mb-3">No appointments yet</h5> <a
											th:href="@{/patient/appointments/book}"
											class="btn btn-primary"> <i class="fas fa-plus"></i> Book
												Your First Appointment
										</a>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div th:replace="~{fragments/header :: scripts}"></div>
</body>
</html>